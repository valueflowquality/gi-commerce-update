<div class="container preloader-wrapper" ng-if="!pricesLoaded">
  <div class="preloader">
    <div class="dot"></div>
    <div class="dot"></div>
    <div class="dot"></div>
  </div>
</div>
<div ng-show="pricesLoaded" class="container gi-cart checkout-container">
  <div class="row">
    <div ng-if="errorMessage" ng-click="removeError()" class="error-box">{{ errorMessage }}</div>
  </div>
  <div class="row" ng-show="cart.totalItems() === 0 && !inPayment">
    <div class="col-xs-12 col-sm-6 col-sm-offset-3 well">
      <p>Your cart is empty</p>
    </div>
  </div>
  <div ng-cloak ng-show="cart.totalItems() > 0">
    <span us-spinner="{radius:30, width:8, length: 16}" spinner-key="gi-cart-spinner-1"></span>
    <div ng-form name="checkoutForm" class="checkout-form" ng-show="!inPayment">
      <div class="checkout-flex-container">
        <div class="checkout-mobile-section-title-wrapper">
          <div class="checkout-section-title">
            Checkout
          </div>
          <div class="login-reminder-container" ng-if="!model.me.loggedIn">
            <div class="sign-in-button" ng-click="showLoginForm()">SIGN IN</div>
          </div>
        </div>
        <div class="checkout-mobile-product-section">
          <div class="cart-title">Cart</div>
          <div class="cart-item-counter">{{cartItems.length}}</div>
          <div class="cart-items">
            <div class="cart-item" ng-repeat="item in cartItems track by $index">
              <div class="cart-item-info">
                <div class="cart-item-type">{{ getTypeName(item) }}</div>
                <div class="cart-item-title">{{ item.getName() }}</div>
                <div class="cart-item-description">{{ item.getData().basketDescription }}</div>
              </div>
              <div class="cart-item-buttons">
                <div class="cart-item-price">{{ item.getTotal(cart.getPricingInfo()) | giCurrency:cart.getCurrencySymbol() }}</div>
                <div class="cart-item-delete" ng-click="cart.removeItem($index)">Remove</div>
              </div>
            </div>
          </div>
          <div class="confirm-total">
            <div class="confirm-total-title">Total</div>
            <div class="confirm-total-price">{{ cart.totalCost(isTrial) | giCurrency:cart.getCurrencySymbol() }}</div>
          </div>
        </div>
        <div class="checkout-input-section">
          <div class="checkout-section-title-wrapper">
            <div class="checkout-section-title">
              Checkout
            </div>
            <div class="login-reminder-container" ng-if="!model.me.loggedIn">
              <div class="sign-in-button" ng-click="showLoginForm()">SIGN IN</div>
            </div>
          </div>
          <div class="checkout-subsection" ng-if="!model.me.loggedIn">
            <div class="checkout-subsection-title">
              Personal Details
            </div>
            <div class="checkout-input-container">
              <div class="checkout-input-row">
                <div class="form-group error-container">
                  <div data-hj-suppress="" class="input-container"
                    ng-class="{'has-error': isPropertyValidationError('firstName'), 'has-success': isPropertyValidationSuccess('firstName')}">
                    <input class="form-control"
                      type="text"
                      tabindex="1"
                      maxlength="50"
                      name="firstName"
                      ng-model="cart.customerInfo.firstName"
                      placeholder="First Name"
                      required/><!--
                    --><div class="input-validity-indicator">
                      <div class="validity-icon">
                      </div>
                    </div>
                  </div>
                  <div class="error-tooltip left-error-tooltip" ng-show="errorMessages['firstName']">
                    {{ errorMessages['firstName'] }}
                    <div class="arrow-tip"></div>
                  </div>
                </div>
                <div class="form-group error-container">
                  <div data-hj-suppress="" class="input-container"
                    ng-class="{'has-error': isPropertyValidationError('lastName'), 'has-success': isPropertyValidationSuccess('lastName')}">
                    <input class="form-control"
                      type="text"
                      tabindex="1"
                      name="lastName"
                      maxlength="50"
                      ng-model="cart.customerInfo.lastName"
                      ng-pattern="lastNameRegex"
                      placeholder="Last Name"
                      ng-trim="false"
                      required/><!--
                    --><div class="input-validity-indicator">
                      <div class="validity-icon">
                      </div>
                    </div>
                  </div>
                  <div class="error-tooltip right-error-tooltip" ng-show="errorMessages['lastName']">
                    {{ errorMessages['lastName'] }}
                    <div class="arrow-tip"></div>
                  </div>
                </div>
              </div>
              <div class="checkout-input-row">
                <div class="form-group error-container">
                  <div data-hj-suppress="" class="input-container"
                    ng-class="{'has-error': isPropertyValidationError('email'), 'has-success': isPropertyValidationSuccess('email')}">
                    <input class="form-control"
                      type="email"
                      tabindex="1"
                      name="email"
                      maxlength="100"
                      placeholder="Email"
                      ng-model="cart.customerInfo.email"
                      ng-pattern="emailRegex"
                      gi-username
                      required/><!--
                    --><div class="input-validity-indicator">
                      <div class="validity-icon">
                      </div>
                    </div>
                  </div>
                  <div class="error-tooltip left-error-tooltip" ng-show="errorMessages['email']">
                    {{ errorMessages['email'] }}
                    <div class="arrow-tip"></div>
                  </div>
                </div>
              </div>
              <div class="checkout-input-row">
                <div class="form-group error-container">
                  <div data-hj-suppress="" class="input-container"
                    ng-class="{'has-error': isPropertyValidationError('password'), 'has-success': isPropertyValidationSuccess('password')}">
                    <input class="form-control"
                      type="password"
                      tabindex="1"
                      maxlength="50"
                      name="password"
                      placeholder="Password"
                      ng-model="cart.customerInfo.password"
                      gi-password
                      ng-required="!model.me.loggedIn"/><!--
                    --><div class="input-validity-indicator">
                      <div class="validity-icon">
                      </div>
                    </div>
                  </div>
                  <div class="error-tooltip left-error-tooltip" ng-show="errorMessages['password']">
                    {{ errorMessages['password'] }}
                    <div class="arrow-tip"></div>
                  </div>
                </div>
                <div class="form-group error-container">
                  <div data-hj-suppress="" class="input-container"
                    ng-class="{'has-error': isPropertyValidationError('confirm'), 'has-success': isPropertyValidationSuccess('confirm')}">
                    <input class="form-control"
                      type="password"
                      tabindex="1"
                      maxlength="50"
                      name="confirm"
                      ng-model="cart.customerInfo.confirm"
                      placeholder="Confirm Password"
                      gi-match="cart.customerInfo.password"
                      ng-required="!model.me.loggedIn"
                      tabindex="1"/><!--
                    --><div class="input-validity-indicator">
                      <div class="validity-icon">
                      </div>
                    </div>
                  </div>
                  <div class="error-tooltip right-error-tooltip" ng-show="errorMessages['confirm']">
                    {{ errorMessages['confirm'] }}
                    <div class="arrow-tip"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="checkout-welcome-back" ng-if="model.me.loggedIn">
            <div class="welcome-back-text">
              <div class="welcome-back-title">Welcome back, {{ model.me.user.firstName }}</div>
              <div class="welcome-back-email">{{ model.me.user.email }}</div>
            </div>
            <div ng-click="logout()" class="sign-out-button">
              SIGN OUT
            </div>
          </div>
          <div class="checkout-subsection">
            <div class="checkout-subsection-title">
              Payment Information
            </div>
            <div class="form-group company-checkbox"
              ng-click="cart.business = !cart.business"
              ng-class="{checked: cart.business}">
              <div class="checkbox checkbox-success">
                <input type="checkbox" ng-model="cart.business">
                <label unselectable="on" class="no-selection">Buying for a business?</label>
              </div>
            </div>
            <div class="checkout-input-container">
              <div class="checkout-input-row" ng-show="cart.business">
                <div class="form-group error-container">
                  <div class="input-container"
                    ng-class="{'has-error': isPropertyValidationError('companyName'), 'has-success': isPropertyValidationSuccess('companyName')}">
                    <input data-hj-suppress="" class="form-control"
                      type="text"
                      tabindex="1"
                      maxlength="100"
                      name="companyName"
                      ng-model="cart.company.name"
                      ng-required="cart.business"
                      placeholder="Company"/><!--
                    --><div class="input-validity-indicator">
                      <div class="validity-icon">
                      </div>
                    </div>
                  </div>
                  <div class="error-tooltip left-error-tooltip" ng-show="errorMessages['companyName']">
                    {{ errorMessages['companyName'] }}
                    <div class="arrow-tip"></div>
                  </div>
                </div>
                <div class="form-group error-container">
                  <div data-hj-suppress="" class="input-container"
                    ng-class="{'has-error': isPropertyValidationError('vat'), 'has-success': isPropertyValidationSuccess('vat')}">
                    <input class="form-control"
                      type="text"
                      tabindex="1"
                      maxlength="50"
                      name="vat"
                      ng-model="cart.company.VAT"
                      placeholder="VAT Number (optional)"
                      gi-vat/><!--
                    --><div class="input-validity-indicator">
                      <div class="validity-icon">
                      </div>
                    </div>
                  </div>
                  <div class="error-tooltip right-error-tooltip" ng-show="errorMessages['vat']">
                    {{ errorMessages['vat'] }}
                    <div class="arrow-tip"></div>
                  </div>
                </div>
              </div>
              <div class="checkout-input-row">
                <div class="checkout-card-wrapper" data-hj-suppress=""
                  ng-class="{'has-error': cart.isCardElementFormValid() == false, 'has-success': cart.isCardElementFormValid() == true}">
                  <div id="checkout-card-container"></div><!--
                    --><div class="input-validity-indicator">
                      <div class="validity-icon">
                      </div>
                    </div>
                </div>
              </div>
              <!-- <div class="checkout-input-row">
                <div class="form-group">
                  <div data-hj-suppress="" class="input-container"
                    ng-class="{'has-error': isPropertyValidationError('couponCode'), 'has-success': isPropertyValidationSuccess('couponCode')}">
                    <input class="form-control"
                      type="text"
                      tabindex="1"
                      maxlength="50"
                      name="couponCode"
                      ng-model="cart.couponCode"
                      placeholder="Promotional Code" coupon-valid/>
                    <div class="input-validity-indicator">
                      <div class="validity-icon">
                      </div>
                    </div>
                  </div>
                </div>
              </div> -->
            </div>
          </div>
          <div class="checkout-subsection">
            <div class="checkout-subsection-title">
              Billing Address
            </div>
            <div class="checkout-input-container">
              <div class="checkout-input-row">
                <div class="form-group error-container">
                  <div data-hj-suppress="" class="input-container"
                    ng-class="{'has-error': isPropertyValidationError('billing-line1'), 'has-success': isPropertyValidationSuccess('billing-line1')}">
                    <input class="form-control"
                      type="text"
                      tabindex="1"
                      maxlength="100"
                      placeholder="Address line 1"
                      name="billing-line1"
                      ng-model="cart.billingAddress.line1"
                      required/><!--
                    --><div class="input-validity-indicator">
                      <div class="validity-icon"></div>
                    </div>
                  </div>
                  <div class="error-tooltip left-error-tooltip" ng-show="errorMessages['billing-line1']">
                    {{ errorMessages['billing-line1'] }}
                    <div class="arrow-tip"></div>
                  </div>
                </div>
                <div class="form-group error-container">
                  <div data-hj-suppress="" class="input-container"
                    ng-class="{'has-error': isPropertyValidationError('billing-line2'), 'has-success': isPropertyValidationSuccess('billing-line2')}">
                    <input class="form-control"
                      type="text"
                      tabindex="1"
                      maxlength="100"
                      placeholder="Address line 2 (optional)"
                      name="billing-line2"
                      ng-model="cart.billingAddress.line2"/><!--
                    --><div class="input-validity-indicator">
                      <div class="validity-icon"></div>
                    </div>
                  </div>
                  <div class="error-tooltip right-error-tooltip" ng-show="errorMessages['billing-line2']">
                    {{ errorMessages['billing-line2'] }}
                    <div class="arrow-tip"></div>
                  </div>
                </div>
              </div>
              <div class="checkout-input-row">
                <div class="form-group error-container">
                  <div data-hj-suppress="" class="input-container"
                    ng-class="{'has-error': isPropertyValidationError('billing-city'), 'has-success': isPropertyValidationSuccess('billing-city')}">
                    <input class="form-control"
                      type="text"
                      tabindex="1"
                      maxlength="50"
                      name="billing-city"
                      placeholder="City"
                      ng-model="cart.billingAddress.city"
                      required/><!--
                    --><div class="input-validity-indicator">
                      <div class="validity-icon">
                      </div>
                    </div>
                  </div>
                  <div class="error-tooltip left-error-tooltip" ng-show="errorMessages['billing-city']">
                    {{ errorMessages['billing-city'] }}
                    <div class="arrow-tip"></div>
                  </div>
                </div>
                <div class="form-group error-container">
                  <div data-hj-suppress="" class="input-container"
                    ng-class="{'has-error': isPropertyValidationError('billing-state'), 'has-success': isPropertyValidationSuccess('billing-state')}">
                    <input class="form-control"
                      type="text"
                      tabindex="1"
                      name="billing-state"
                      placeholder="State/Region (optional)"
                      maxlength="100"
                      ng-model="cart.billingAddress.state"/><!--
                    --><div class="input-validity-indicator">
                      <div class="validity-icon"></div>
                    </div>
                  </div>
                  <div class="error-tooltip right-error-tooltip" ng-show="errorMessages['billing-state']">
                    {{ errorMessages['billing-state'] }}
                    <div class="arrow-tip"></div>
                  </div>
                </div>
              </div>
              <div class="checkout-input-row">
                <div data-hj-suppress="" class="form-group error-container" ng-class="{'has-success': validCountry}">
                  <ui-select class="checkout-select" tabindex="1" required on-select="checkValid($select.selected.name)" ng-model="cart.billingAddress.country">
                    <ui-select-match placeholder="Country">{{$select.selected.name}}</ui-select-match>
                    <ui-select-choices repeat="t.code as t in model.countries | orderBy:getCountrySorter() | filter: $select.search">
                      <div ng-bind-html="t.name | highlight: $select.search"></div>
                    </ui-select-choices>
                  </ui-select>
                </div>
                <div class="form-group error-container">
                  <div data-hj-suppress="" class="input-container"
                    ng-class="{'has-error': isPropertyValidationError('billing-code'), 'has-success': isPropertyValidationSuccess('billing-code')}">
                    <input class="form-control"
                      type="text"
                      tabindex="1"
                      name="billing-code"
                      placeholder="Postcode"
                      maxlength="10"
                      ng-model="cart.billingAddress.code"
                      required/><!--
                    --><div class="input-validity-indicator">
                      <div class="validity-icon">
                      </div>
                    </div>
                  </div>
                  <div class="error-tooltip right-error-tooltip" ng-show="errorMessages['billing-code']">
                    {{ errorMessages['billing-code'] }}
                    <div class="arrow-tip"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="checkout-product-section-wrapper">
          <div class="checkout-product-section">
            <div class="checkout-product-cart-section">
              <div class="cart-title">Cart</div>
              <div class="cart-item-counter">{{cartItems.length}}</div>
              <div class="cart-items">
                <div class="cart-item" ng-repeat="item in cartItems track by $index">
                  <div class="cart-item-info">
                    <div class="cart-item-type">{{ getTypeName(item) }}</div>
                    <div class="cart-item-title">{{ item.getName() }}</div>
                    <div class="cart-item-description">{{ item.getData().basketDescription }}</div>
                  </div>
                  <div class="cart-item-buttons">
                    <div class="cart-item-price">{{ item.getTotal(cart.getPricingInfo()) | giCurrency:cart.getCurrencySymbol() }}</div>
                    <div class="cart-item-delete" ng-click="cart.removeItem($index)">Remove</div>
                  </div>
                </div>
              </div>
            </div>
            <div class="cart-confirm">
              <div class="purchase-summary">
                <div class="confirm-title">Review & Confirm</div>
                <div class="confirm-description">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore. Lorem ipsum dolor sit amet, dolore.</div>
                <div class="confirm-total">
                  <div class="confirm-total-title">Total</div>
                  <div class="confirm-total-price">{{ cart.totalCost(isTrial) | giCurrency:cart.getCurrencySymbol() }}</div>
                </div>
              </div>
              <div class="purchase-button"
                ng-click="purchase()"
                gi-enter="purchase()"
                ng-disabled="cart.isCheckoutFormInvalid() || isSpinnerShown">
                PAY NOW
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
